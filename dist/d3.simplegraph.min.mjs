/*! For license information please see d3.simplegraph.min.mjs.LICENSE.txt */
import*as t from"d3";var e={d:(t,s)=>{for(var i in s)e.o(s,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:s[i]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},s={};e.d(s,{A:()=>o});const r=t,n=["diamond","circle","square","triangle","triangle-up","triangle-down"];function a(t){(t=t||{}).container=t.container||"body",t.margins=t.margins||{},t.axis=t.axis||{},t.styles=t.styles||{},this.allowDrawBeyondGraph=!!t.allowDrawBeyondGraph,Array.isArray(t.margins)&&(t.margins={top:t.margins[0],right:t.margins[1],bottom:t.margins[2],left:t.margins[3]}),this.margins={left:t.margins.left||0===t.margins.left?t.margins.left:40,right:t.margins.right||0===t.margins.right?t.margins.right:20,top:t.margins.top||0===t.margins.top?t.margins.top:20,bottom:t.margins.bottom||0===t.margins.bottom?t.margins.bottom:40},this.containerWidth=t.width||600,this.containerHeight=t.height||400,this.width=this.containerWidth-this.margins.left-this.margins.right,this.height=this.containerHeight-this.margins.top-this.margins.bottom,this.color=t.colorScale?t.colorScale:r.scaleOrdinal(r.schemeCategory10),this.customColors={},this.svg=r.select(t.container).append("svg").attr("width",this.containerWidth).attr("height",this.containerHeight).style("font-family","'Century Gothic', CenturyGothic, Geneva, AppleGothic, sans-serif").style("overflow","visible"),this.svgDefs=this.svg.append("defs"),this.svgGraph=this.svg.append("g").attr("transform","translate("+this.margins.left+","+this.margins.top+")");for(let e in t.styles)this.svg.style(e,t.styles[e]);return this.resetAxisOptions(t.axis),this}a.prototype.getSvgElement=function(){return this.svg},a.prototype.getSvgGraphic=function(){return this.svgGraph},a.prototype.remove=function(){return this.svg.remove(),this},a.prototype.destroy=function(){this.svg.remove(),this.svg=null,this.svgGraph=null,this.clearAllData(),this.color=null,this.customColors=null,this.x=null,this.y=null,this.minMax=null,this.xScale=null,this.yScale=null,this.yAxis=null,this.xAxis=null,this.yGridAxis=null,this.xGridAxis=null,this.points=null,this.ptSeriesShapes=null,this.lines=null,this.pointLines=null,this.areas=null},function(t,e){t.prototype.resetAxisOptions=function(t){return t||(t={}),t.x||(t.x={}),t.y||(t.y={}),t.styles||(t.styles={}),this.axisStyles=t.style,this.axisStyles=this.axisStyles||{},this.axisStyles.fill=this.axisStyles.fill||"none",this.axisStyles["stroke-width"]=this.axisStyles["stroke-width"]||.5,this.axisStyles.stroke=this.axisStyles.stroke||"black",["x","y","y2"].forEach((s=>{if(!t[s]){if("y2"===s)return;t[s]={}}t[s].scale||(t[s].scale=e.scaleLinear);let i,r,n=t[s].scale===e.scaleTime||t[s].scale===e.scaleUtc,a=!n&&t[s].scale===e.scaleLog;if(t[s].format||(t[s].format=n?"%Y-%m-%d":".0f"),t[s].grid||(t[s].grid={}),a&&!t[s].logBase&&(t[s].logBase=10),this[s]={label:null===t[s].label?"x"===s?"x-value":"y-value":t[s].label,isDate:n,isLog:a},n?t[s].scale===e.scaleUtc?this[s].format=e.utcFormat(t[s].format):this[s].format=e.timeFormat(t[s].format):this[s].format=e.format(t[s].format),this[s].min=t[s].min?t[s].min:0,this[s].max=t[s].max?t[s].max:100,this[s].scale=t[s].scale(),a&&this[s].scale.base(t[s].logBase),t[s].break){this[s].break=t[s].break,i=[this[s].min,this[s].break.domain[0],this[s].break.domain[1],this[s].max];let e=n?i.map((t=>t.getTime())):i,a="x"===s?this.width:this.height;r="x"===s?[0,0,0,a]:[a,0,0,0];let o=(a-this[s].break.rangegap)/(e[1]-e[0]+e[3]-e[2]);r[1]=o*(e[1]-e[0]),r[2]=r[1]+this[s].break.rangegap}else i=[this[s].min,this[s].max],r="x"===s?[0,this.width]:[this.height,0];this[s].scale.domain(i).range(r);let o=!1;"x"===s?(o=!0,this[s].axis=e.axisBottom(this[s].scale),this[s].axisTwo=e.axisTop(this[s].scale),this[s].gridAxis=e.axisBottom(this[s].scale)):"y2"===s?(this[s].axis=e.axisRight(this[s].scale),this[s].gridAxis=e.axisRight(this[s].scale)):(this[s].axis=e.axisLeft(this[s].scale),this[s].gridAxis=e.axisLeft(this[s].scale)),a?(this[s].axis.tickFormat(this[s].format),t[s].ticks?this[s].axis.ticks(t[s].ticks,this[s].format):(this[s].axis.ticks(this[s].format),t[s].tickValues&&this[s].axis.tickValues(t[s].tickValues)),o&&(this[s].axisTwo.tickFormat(this[s].format),t[s].ticks?this[s].axisTwo.ticks(t[s].ticks,this[s].format):(this[s].axisTwo.ticks(this[s].format),t[s].tickValues&&this[s].axisTwo.tickValues(t[s].tickValues)))):(this[s].axis.tickFormat(this[s].format),t[s].tickValues?(this[s].axis.tickValues(t[s].tickValues),this[s].gridAxis.tickValues(t[s].tickValues)):(t[s].ticks||0===t[s].ticks)&&(Array.isArray(t[s].ticks)?(this[s].axis.ticks(t[s].ticks[0],t[s].ticks[1]),this[s].gridAxis.ticks(t[s].ticks[0],t[s].ticks[1])):(this[s].axis.ticks(t[s].ticks),this[s].gridAxis.ticks(t[s].ticks))),this[s].gridAxis.tickFormat(this[s].format),t[s].grid.tickValues?this[s].gridAxis.tickValues(t[s].grid.tickValues):(t[s].grid.ticks||0===t[s].grid.ticks)&&(Array.isArray(t[s].grid.ticks)?this[s].gridAxis.ticks(t[s].grid.ticks[0],t[s].grid.ticks[1]):this[s].gridAxis.ticks(t[s].grid.ticks)),o&&(this[s].axisTwo.tickFormat(this[s].format),t[s].tickValues?this[s].axisTwo.tickValues(t[s].tickValues):(t[s].ticks||0===t[s].ticks)&&(Array.isArray(t[s].ticks)?this[s].axisTwo.ticks(t[s].ticks[0],t[s].ticks[1]):this[s].axisTwo.ticks(t[s].ticks))))})),this.minMax={x:[this.x.min,this.x.max],y:[this.y.min,this.y.max]},this.xScale=this.x.scale,this.xAxis=this.x.axis,this.xGridAxis=this.x.gridAxes,this.yScale=this.y.scale,this.yAxis=this.y.axis,this.yGridAxis=this.y.gridAxes,this.removeAll(),this.drawAxes(),this},t.prototype.drawAxes=function(t,e,s){e?"top"!==(e=e.toLowerCase().trim())&&(e="bottom"):e="bottom";let i,r=0;"top"!==e?(i=this.x.axis,r=this.height):i=this.x.axisTwo,s||(s=0),this.svg.selectAll(".sg-xaxis, .sg-yaxis, .sg-y2axis, .sg-axis-label").remove();let n=this.svgGraph.append("g").attr("class","sg-xaxis").attr("transform","translate(0,"+r+")").call(i).attr("font-size",null).attr("font-family",null),a=this.svgGraph.append("g").attr("class","sg-yaxis").call(this.y.axis).attr("font-size",null).attr("font-family",null),o=this.y2?this.svgGraph.append("g").attr("class","sg-y2axis").attr("transform","translate("+this.width+",0)").call(this.y2.axis).attr("font-size",null).attr("font-family",null):null;this.svgGraph.selectAll(".tick line").style("stroke","#000");let l=this.svgGraph.selectAll(".sg-xaxis .domain, .sg-yaxis .domain, .sg-y2axis .domain");for(let t in this.axisStyles)l.style(t,this.axisStyles[t]);let h={x:0,y:0,y2:0};this.svgGraph.selectAll(".sg-xaxis .tick").each((function(){this.getBBox().height>h.x&&(h.x=this.getBBox().height)})),this.svgGraph.selectAll(".sg-yaxis .tick").each((function(){this.getBBox().width>h.y&&(h.y=this.getBBox().width)})),this.svgGraph.selectAll(".sg-y2axis .tick").each((function(){this.getBBox().width>h.y2&&(h.y2=this.getBBox().width)}));let p={a:"middle",x:.5*this.width,y:"top"===e?-(h.x+s):h.x+10+s},y={a:"middle",x:-.5*this.height,y:-(h.y+10+s)},c={a:"middle",x:.5*this.height,y:-(h.y2+10+s)},d="center",u="center",g="center",f="outside",x="outside",m="outside";return t&&((t||"").toLowerCase().split(/[ ,]+/).forEach((t=>{let i=t.trim().split("-"),r=i.length>1&&i[0];switch(t=i.length>1?i[i.length-1]:i[0]){case"outside":r&&"x"!==r||(p.y="top"===e?-(h.x+s):h.x+10+s,f="outside"),r&&"y"!==r||(y.y=-(h.y+10+s),x="outside"),r&&"y2"!==r||(c.y=-(h.y2+10+s),m="outside");break;case"inside":r&&"x"!==r||(p.y="top"===e?14+s:-(6+s),f="inside"),r&&"y"!==r||(y.y=5,x="inside"),r&&"y2"!==r||(c.y=5,m="inside");case"center":r&&"x"!==r||(p.a="middle",p.x=.5*this.width,d="center"),r&&"y"!==r||(y.a="middle",y.x=-.5*this.height,u="center"),r&&"y2"!==r||(c.a="middle",c.x=.5*this.height,g="center");break;case"left":p.a="start",p.x=0,d="left";break;case"right":p.a="end",p.x=this.width,d="right";break;case"top":r&&"y"!==r||(y.a="end",y.x=0,u="top"),r&&"y2"!==r||(c.a="start",c.x=0,g="top");break;case"bottom":r&&"y"!==r||(y.a="start",y.x=-this.height,u="bottom"),r&&"y2"!==r||(c.a="end",c.x=this.height,g="bottom")}})),"inside"===f&&("left"===d?p.x+=10:"right"===d&&this.y2&&(p.x-=10),"bottom"===e?("left"===d&&"inside"===x&&"bottom"===u&&(p.x+=10,y.x+=10),"right"===d&&this.y2&&"inside"===m&&"bottom"===g&&(p.x-=10,c.x-=10)):("left"===d&&"inside"===x&&"top"===u&&(p.x+=10,y.x-=10),"right"===d&&this.y2&&"inside"===m&&"top"===g&&(p.x-=10,c.x+=10)))),"inside"===x&&("top"===u&&(y.x-=5),"bottom"===u&&(y.x+=5)),"inside"===m&&("top"===g&&(c.x+=5),"bottom"===g&&(y2LLabelPos.x-=5)),n.append("text").attr("class","sg-axis-label sg-xaxis").attr("x",p.x).attr("y",p.y).attr("fill","#000").style("text-anchor",p.a).style("font-weight","bolder").text(this.x.label),a.append("text").attr("class","sg-axis-label sg-yaxis").attr("transform","rotate(-90)").attr("x",y.x).attr("y",y.y).attr("dy",".71em").attr("fill","#000").style("text-anchor",y.a).style("font-weight","bolder").text(this.y.label),o&&o.append("text").attr("class","sg-axis-label sg-y2axis").attr("transform","rotate(90)").attr("x",c.x).attr("y",c.y).attr("dy",".71em").attr("fill","#000").style("text-anchor",c.a).style("font-weight","bolder").text(this.y2.label),this}}(a,r),function(t){t.prototype.getColorBySeriesName=function(t,e){if(!t)return null;if(t in this.customColors)return this.customColors[t];if(this.points){let s;for(let i in this.points)if(s=this.points[i],t===s.series)return s.style&&s.style.fill?s.style.fill:e||this.color.domain().indexOf(t)>=0?this.color(t):null}if(this.lines){let s;for(let i in this.lines)if(s=this.lines[i],t===s.series)return s.style&&s.style.stroke?s.style.stroke:e||this.color.domain().indexOf(t)>=0?this.color(t):null}if(this.areas){let s;for(let i in this.areas)if(s=this.areas[i],t===s.series)return s.style&&s.style.fill?s.style.fill:e||this.color.domain().indexOf(t)>=0?this.color(t):null}return e?this.color(t):null},t.prototype.resetColorScale=function(t){return t?this.color=t:this.color.domain([]),this},t.prototype.setSeriesColor=function(t,e){this.customColors[t]=e},t.prototype.removeSeriesColor=function(t){return this.customColors[t]&&delete this.customColors[t],this}}(a),function(t){t.prototype.drawGrid=function(t){this.svgGraph.selectAll(".sg-grid").remove();let e=t&&t.opacity?parseFloat(t.opacity):.4,s=t&&t.stroke?t.stroke:"#555",i=t&&t["stroke-width"]?parseFloat(t["stroke-width"]):.3;return this.svgGraph.append("g").attr("class","sg-grid").attr("transform","translate(0,"+this.height+")").style("opacity",e).style("stroke",s).style("stroke-width",i).call(this.x.gridAxis.tickSize(-this.height).tickFormat("")),this.svgGraph.append("g").attr("class","sg-grid").style("opacity",e).style("stroke",s).style("stroke-width",i).call(this.y.gridAxis.tickSize(-this.width).tickFormat("")),this},t.prototype.removeGrid=function(){return this.svgGraph.selectAll(".sg-grid").remove(),this},t.prototype.removeLegend=function(){return this.svg.selectAll(".sg-legend").remove(),this},t.prototype.drawLegend=function(t,e){this.removeLegend(),t?t.x&&t.y||(t.x||0===t.x||(t.x=void 0!==t[0]&&"number"==typeof t[0]?t[0]:this.width+5),t.y||0===t.y||(t.y=void 0!==t[1]&&"number"==typeof t[1]?t[1]:0)):t={x:0,y:0};let s=(e=e||{}).anchor||"left",i=e.bgstyle||{},r=e.exclude||[];r||(r=[]),"string"==typeof r&&(r=r.trim().split(/\s+/));let n={all:[],points:[],lines:[],areas:[]};r.forEach((t=>{let e=n.all,s=t.split("::").map((t=>t.trim()));if(s.length>1)switch(s[1].toLowerCase()){case"point":case"points":s[0]||(n.points=!0),e=n.points;break;case"line":case"lines":s[0]||(n.lines=!0),e=n.lines;break;case"area":case"areas":s[0]||(n.areas=!0),e=n.areas;break;default:return}!0!==e&&e.push(s[0])}));let a=(t,e)=>!0===n[e]||~n[e].indexOf(t)||!n.all.indexOf(t);if(i.padding){let t="string"==typeof i.padding?i.padding.split(" "):[i.padding];1===t.length?(i["padding-left"]=t[0],i["padding-right"]=t[0],i["padding-top"]=t[0],i["padding-bottom"]=t[0]):2===t.length?(i["padding-left"]=t[1],i["padding-right"]=t[1],i["padding-top"]=t[0],i["padding-bottom"]=t[0]):(t.length>3&&(i["padding-left"]=t[3]),i["padding-right"]=t[1],i["padding-top"]=t[0],i["padding-bottom"]=t[2]),delete i.padding}else i["padding-left"]||(i["padding-left"]=0),i["padding-right"]||(i["padding-right"]=0),i["padding-top"]||(i["padding-top"]=0),i["padding-bottom"]||(i["padding-bottom"]=0);i.fill||(i.fill="#fff",i.opacity=0),i["padding-left"]=parseInt(i["padding-left"]),i["padding-right"]=parseInt(i["padding-right"]),i["padding-top"]=parseInt(i["padding-top"]),i["padding-bottom"]=parseInt(i["padding-bottom"]);var o=this.svg.append("g").attr("class","sg-legend").attr("transform","translate("+t.x+","+t.y+")"),l=o.append("rect").attr("class","sg-legend-bg").attr("x",0).attr("y",0);for(let t in i)t.startsWith("padding")||l.style(t,i[t]);let h=e.itemsPerColumn||0,p=e.rowHeight||24,y=0,c=i["padding-top"],d=i["padding-left"];function u(){y++,h>0&&y>=h?(y=0,c=i["padding-top"],d=o.node().getBBox().width+12):c+=p}var g=this;function f(t,e,s,i){if(i){let e=c+10,s=o.append("path").attr("x",d).attr("y",c).attr("d","M"+d+" "+e+" L"+(18+d)+" "+e);for(let t in g.pointLines[0].style)s.style(t,g.pointLines[0].style[t]);s.style("stroke",g.getColorBySeriesName(t.series))}let r="function"==typeof t.size?t.size():t.size;r>14&&(r=14);let n=d+2,a=c+3;if(e&&e.startsWith("triangle")){let t=1.519676*r,i=t/2,l=.86602*t;switch(n+=7-i,a+=7-.5*l,e){case"triangle-down":o.append("polygon").attr("points",`${n},${a+l} ${n+i},${a} ${n+t},${a+l}`).style("fill",s);break;case"triangle":case"triangle-up":o.append("polygon").attr("points",`${n},${a} ${n+i},${a+l} ${n+t},${a}`).style("fill",s)}}else{let t=r/2,i=7-t;n+=i,a+=i,"circle"===e?o.append("circle").attr("cx",n+t).attr("cy",a+t).attr("r",t).style("fill",s):o.append("rect").attr("x",n).attr("y",a).attr("width",r).attr("height",r).attr("transform","square"==e?"":`rotate(45,${n+t},${a+t})`).style("fill",s)}o.append("text").attr("x",d+23).attr("y",c+9).attr("dy",".35em").style("text-anchor","start").text(t.series),u()}function x(t,e){let s=c+10,i=o.append("path").attr("x",d).attr("y",c).attr("d","M"+d+" "+s+" L"+(18+d)+" "+s);for(let e in t.style)i.style(e,t.style[e]);"stroke"in t.style||i.style("stroke",e),o.append("text").attr("x",d+23).attr("y",c+9).attr("dy",".35em").style("text-anchor","start").text(t.series),u()}function m(t,e){let s=o.append("rect").attr("x",d).attr("y",c).attr("width",18).attr("height",18);for(let e in t.style)s.style(e,t.style[e]);"fill"in t.style||s.style("fill",e),o.append("text").attr("x",d+23).attr("y",c+9).attr("dy",".35em").style("text-anchor","start").text(t.series),u()}if(this.areas&&!0!==n.areas){let t=[];for(let e=0;e<this.areas.length;e++){let s=this.areas[e].series;if(!a(s,"areas")&&!~t.indexOf(s)){t.push(s);let i=this.getColorBySeriesName(s);m(this.areas[e],"function"==typeof i?i(this.areas[e]):i)}}}if(this.lines&&!0!==n.lines){let t=[];for(let e=0;e<this.lines.length;e++){let s=this.lines[e].series;if(!a(s,"lines")&&!~t.indexOf(s)){t.push(s);let i=this.getColorBySeriesName(s);x(this.lines[e],"function"==typeof i?i(this.lines[e]):i)}}}if(this.points&&!0!==n.points){let t=[];for(let e=0;e<this.points.length;e++){let s=this.points[e].series;if(!a(s,"points")&&!~t.indexOf(s)){t.push(s);let i=!1;if(this.pointLines){let t=this.pointLines.length;for(;t--;)if(this.pointLines[t].series===s){i=!0;break}}let r=this.getColorBySeriesName(s);r="function"==typeof r?r(this.points[e]):r,f(this.points[e],this.getPointSeriesShape(s),r,i)}}}let v=o.node().getBBox();return l.attr("width",v.width+i["padding-left"]+i["padding-right"]).attr("height",v.height+i["padding-top"]+i["padding-bottom"]),s=s.trim().toLowerCase(),"middle"===s?t.x-=.5*v.width:"right"===s&&(t.x-=v.width),o.attr("transform","translate("+t.x+","+t.y+")"),this}}(a),function(t){t.prototype.addPointData=function(t,e,s,i){this.points=this.points||[],this.ptSeriesShapes=this.ptSeriesShapes||{},t=null===t?"":String(t),(i=i||{}).size=!i.size||"function"!=typeof i.size&&i.size<=0?i.size=10:i.size,i.y2Axis=!(!i.y2Axis&&!i.y2),i.shape&&this.setPointSeriesShape(t,i.shape);let r={series:t,x:e,y:parseFloat(s),y2:i.y2Axis,size:i.size,_bind:null,_keys:null};return this.points.push(r),this},t.prototype.addPointsData=function(t,e,s,i,r){return t&&0!==t.length?(this.points=this.points||[],this.ptSeriesShapes=this.ptSeriesShapes||{},(r=r||{}).size=!r.size||"function"!=typeof r.size&&r.size<=0?r.size=10:r.size,r.y2Axis=!(!r.y2Axis&&!r.y2),r.additionalDataKeys=r.additionalDataKeys||null,t.forEach(((t,n)=>{let a=!r.forceSeriesName&&!r.forceSeries&&e in t&&t[e],o=a?t[e]:e||0===e?e:n,l=t[s],h=t[i];o=null===o?"":String(o),r.shape&&(this.ptSeriesShapes[o]=r.shape);let p={series:o,x:l,y:parseFloat(h),y2:r.y2Axis,size:r.size,_bind:t,_keys:{x:s,y:i,additional:null}};if(a&&(p._keys.series=e),r.additionalDataKeys&&Array.isArray(r.additionalDataKeys)){let e=[];r.additionalDataKeys.forEach((s=>{let i=s,r=1;for(;i in p;)i=s+String(++r);e.push({key:s,name:i}),p[i]=t[s]})),p._keys.additional=e}this.points.push(p)})),this):this},t.prototype.addPointsDataAsArray=function(t,e,s){if(!e||0===e.length)return this;this.points=this.points||[],this.ptSeriesShapes=this.ptSeriesShapes||{},t=null===t?"":String(t),(s=s||{}).size=!s.size||"function"!=typeof s.size&&s.size<=0?s.size=10:s.size,s.y2Axis=!(!s.y2Axis&&!s.y2),s.showNulls=!!s.showNulls,s.shape&&this.setPointSeriesShape(t,s.shape);var i=this;return e.forEach((e=>{var r={series:t,x:parseFloat(e[0]),y:parseFloat(e[1]),y2:s.y2Axis,size:s.size,_bind:e,_keys:{x:0,y:1,additional:null}};if(isNaN(r.y)||!r.y&&0!==r.y){if(!showNulls)return;r.y=0,r.wasNull=!0}i.points.push(r)})),this},t.prototype.clearPointsData=function(t){return null==t?this.points=null:Array.isArray(t)?this.points=this.points.filter((e=>~t.indexOf(e.series))):this.points=this.points.filter((e=>e.series!==t)),this},t.prototype._getPointData=function(t,e){if(!this.points)return[];var s=this.points.filter((e=>e.series===t));if(!s||!s.length)return this;if(e||0===e){for(;e<0;)e=s.length+e;s=[s[e]]}return s},t.prototype._clonePointData=function(t){let e={series:t.series,x:t.x,y:t.y,y2:t.y2,size:t.size};return t._keys&&(t._keys.x&&(e[t._keys.x]=t.x),t._keys.y&&(e[t._keys.y]=t.y),t._keys.additional&&t._keys.additional.forEach((s=>{e[s.name]=t[s.name]}))),e},t.prototype.getPointsDataBySeries=function(t){return this._getPointData(t).map((t=>this._clonePointData(t)))},t.prototype.getPointCoordinatesBySeries=function(t){return this._getPointData.map((t=>[t.x,t.y||0===t.y?t.y:t.y2]))},t.prototype.getPointSeriesShape=function(t){return this.ptSeriesShapes=this.ptSeriesShapes||{},this.ptSeriesShapes[t]},t.prototype.setPointSeriesShape=function(t,e){return this.ptSeriesShapes=this.ptSeriesShapes||{},this.ptSeriesShapes[t]=~n.indexOf(e)?e:null,this},t.prototype.updatePointsData=function(t,e,s){return this._getPointData(t,e).forEach((t=>{["x","y","y2","size"].forEach((e=>{e in s&&null!==s[e]&&void 0!==typeof s[e]&&(t[e]=s[e],t._keys&&delete t._keys[e])}))})),this._syncPointLinesData(),this},t.prototype.syncPointsData=function(){return this.points?(this.points.forEach((t=>{t._bind&&t._keys&&("series"in t._keys&&t._bind[t._keys.series],"x"in t._keys&&(t.x=parseFloat(t._bind[t._keys.x])),"y"in t._keys&&(t.y=parseFloat(t._bind[t._keys.y])),t._keys.additional&&t._keys.additional.forEach((e=>t[e.name]=t._bind[e.key])))})),this._syncPointLines(),this):this}}(a),function(t,e){t.prototype.addAreaAsCoordinates=function(t,s,i){if(!s||!Array.isArray(s)||s.length<2)return this;var r={};if((i=i||{}).style)for(let t in i.style)r[t]=i.style[t];return this.areas=this.areas||[],this.areas.push({series:null===t?"":String(t),functions:null,coords:s,resolution:null,xRange:null,y2:!(!i.y2Axis&&!i.y2),style:i.style||{},interpolate:i.interpolation||e.curveLinear,_bind:{coords:s,style:r}}),this},t.prototype.addAreaBetweenTwoLines=function(t,s,i,r,n){if(!i||"function"!=typeof i)return this;if(!s||"function"!=typeof s)return this;var a={};if((n=n||{}).style)for(let t in n.style)a[t]=n.style[t];return this.areas=this.areas||[],this.areas.push({series:null===t?"":String(t),functions:[s,i],coords:null,xRange:r?[...r]:null,y2:!(!n.y2Axis&&!n.y2),style:n.style||{},interpolate:n.interpolation||e.curveLinear,_bind:{xRange:r,style:a}}),this},t.prototype._getAreaData=function(t,e){if(!this.areas)return[];var s=this.areas.filter((e=>e.series===t));if(!s||!s.length)return this;if(e||0===e){for(;e<0;)e=s.length+e;s=[s[e]]}return s},t.prototype._cloneAreaData=function(t){return{series:t.series,functions:t.functions?[...t.functions]:null,coords:t.coords?t.coords.map((t=>[...t])):null,xRange:t.xRange?[...t.xRange]:null,y2:t.y2,style:t.style,interpolate:t.interpolate}},t.prototype.getAreasDataBySeries=function(t,e){return this._getAreaData(t,e).map((t=>this._cloneAreaData(t)))},t.prototype.updateAreaData=function(t,e,s){return this._getAreaData(t,e).forEach((t=>{if(s.lineFunctionTop||s.functionTop||s.lineFunctionBottom||s.functionBottom)t.functions=[s.lineFunctionBottom||s.functionBottom||t.functions&&t.functions[0],s.lineFunctionTop||s.functionTop||t.functions&&t.functions[1]],t.functions[0]||(t.functions[0]=t=>0),t.functions[1]||(t.functions[1]=t=>0),s.xRange&&(t.xRange=[...s.xRange],t._bind&&(t._bind.xRange=s.xRange)),t.coords=null,t._bind&&delete t._bind.coords;else if(s.coordinates||s.coords){let e=s.coordinates||s.coords;t.coords=[...e],t.functions=null,t._bind&&(t._bind.coords=e,delete t._bind.xRange)}if(t.interpolate=s.interpolate||t.interpolate,s.style){t.style={};for(let e in s.style)t.style[e]=s.style[e];t._bind&&(t._bind.style=s.style)}})),this},t.prototype.clearAreasData=function(t){return null==t?this.areas=null:Array.isArray(t)?this.areas=this.areas.filter((e=>~t.indexOf(e.series))):this.areas=this.areas.filter((e=>e.series!==t)),this},t.prototype.syncAreasData=function(){return this.areas?(this.areas.forEach((t=>{if(t._bind.xRange&&(t.xRange=[...t._bind.xRange]),t._bind.coords&&(t.coords=t._bind.coords.map((t=>[...t]))),t._bind.style){t.style={};for(let e in update.style)t.style[e]=update.style[e]}})),this):this}}(a,r),function(t,e){t.prototype.addLineDataAsCoordinates=function(t,s,i){if(!s||0===s.length)return this;this.lines=this.lines||[];var r={};if((i=i||{}).style)for(let t in i.style)r[t]=i.style[t];return r["stroke-width"]&&"number"==typeof r["stroke-width"]||(r["stroke-width"]=1.5),this.lines.push({series:null===t?"":String(t),lineFunction:null,coords:s.map((t=>[...t])),xRange:null,y2:!(!i.y2Axis&&!i.y2),style:r,interpolate:i.interpolation||e.curveLinear,_bind:{coords:s,style:r}}),this},t.prototype.addLineDataAsFunction=function(t,s,i,r){if(!s||"function"!=typeof s||"number"!=typeof s(0))return this;this.lines=this.lines||[];var n=(r=r||{}).style||{};if(r.style)for(let t in r.style)n[t]=r.style[t];n["stroke-width"]&&"number"==typeof n["stroke-width"]||(n["stroke-width"]=1.5);var a=a||e.curveLinear;return this.lines.push({series:null===t?"":String(t),lineFunction:s,coords:null,xRange:i?[...i]:null,y2:!(!r.y2Axis&&!r.y2),style:n,interpolate:r.interpolation||e.curveLinear,_bind:{xRange:i,style:n}}),this},t.prototype.addLinesDataFromPoints=function(t,s){if(!this.points||0===this.points.length)return this;var i=(s=s||{}).handleOverlap?s.handleOverlap.toLowerCase():"average",r={};if(s.style)for(let t in s.style)r[t]=s.style[t];r["stroke-width"]&&"number"==typeof r["stroke-width"]||(r["stroke-width"]=1.5),r.stroke&&delete r.stroke;for(var n={},a=0;a<this.points.length;a++){var o=this.points[a].series;o in n?(n[o].y2=this.points[a].y2,n[o].points.push(this.points[a])):n[o]={points:[this.points[a]]}}var l=function(t){return!0};t&&("function"==typeof t?l=t:"string"==typeof t?l=function(e){return e===t}:Array.isArray(t)&&(l=function(e){return~t.indexOf(e)})),this.pointLines=[];for(let t in n)if(l(t)&&!(n[t].points.length<2)){var h=this._getPointLine(n[t].points,i);h.length>=2&&this.pointLines.push({series:t,lineFunction:null,resolution:null,coords:h,xRange:null,y2:n[t].y2,style:r,interpolate:s.interpolation||e.curveLinear,bind:{style:r}})}return this},t.prototype._getPointLine=function(t,e){t.sort(((t,e)=>t.x-e.x));var s=[];for(let o=0;o<t.length;++o){for(var i=t[o],r=[i.y],n=[i.x,i.y],a=!1;o+1<t.length&&(i=t[o+1]).x===n[0];)a=!0,r.push(i.y),++o;if(a)if(~["mean","average"].indexOf(e))n[1]=r.reduce(((t,e)=>t+e));else switch(r.sort(),e){case"lowest":case"min":n[1]=r[0];break;case"highest":case"max":n[1]=r[r.length-1];break;case"median":n[1]=r[Math.floor(.5*r.length)];break;default:throw`Unknown handle overlap operation: ${e}`}s.push(n)}return s},t.prototype.clearLinesData=function(t){return null==t?this.lines=null:Array.isArray(t)?this.lines=this.lines.filter((e=>~t.indexOf(e.series))):this.lines=this.lines.filter((e=>e.series!==t)),this},t.prototype.clearPointLinesData=function(t){return null==t?this.pointLines=null:Array.isArray(t)?this.pointLines=this.pointLines.filter((e=>~t.indexOf(e.series))):this.pointLines=pointLines.lines.filter((e=>e.series!==t)),this},t.prototype._getLineData=function(t,e){if(!this.lines)return[];var s=this.lines.filter((e=>e.series===t));if(!s||!s.length)return[];if(e||0===e){for(;e<0;)e=s.length+e;s=[s[e]]}return s},t.prototype._cloneLineData=function(t){return{series:t.series,lineFunction:t.lineFunction,coords:t.coords?t.coords.map((t=>[...t])):null,xRange:t.xRange?[...t.xRange]:null,y2:t.y2,style:t.style,interpolate:t.interpolate}},t.prototype.getLinesDataBySeries=function(t,e){return this._getLineData(t,e).map((t=>this._cloneLineData(t)))},t.prototype.updateLinesData=function(t,e,s){return this._getLineData(t,e).forEach((t=>{if(s.lineFunction||s.function)t.lineFunction=s.lineFunction||s.function||t.lineFunction,s.xRange&&(t.xRange=[...s.xRange],t._bind&&(t._bind.xRange=s.xRange)),t.coords=null,t._bind&&delete t._bind.coords;else if(s.coordinates||s.coords){let e=s.coordinates||s.coords;t.coords=[...e],t._bind&&(t._bind.coords=e,delete t._bind.xRange)}if(t.interpolate=s.interpolate||t.interpolate,s.style){t.style={};for(let e in s.style)t.style[e]=s.style[e];t.style["stroke-width"]&&"number"==typeof t.style["stroke-width"]||(t.style["stroke-width"]=1.5),t._bind&&(t._bind.style=s.style)}})),this},t.prototype.syncLinesData=function(){return this.lines?(this.lines.forEach((t=>{if(t._bind.xRange&&(t.xRange=[...t._bind.xRange]),t._bind.coords&&(t.coords=t._bind.coords.map((t=>[...t]))),t._bind.style){t.style={};for(let e in t._bind.style)t.style[e]=t._bind.style[e];t.style["stroke-width"]&&"number"==typeof t.style["stroke-width"]||(t.style["stroke-width"]=1.5)}})),this):this},t.prototype._syncPointLines=function(){if(this.pointLines){var t={};this.points.forEach((e=>{let s=e.series;s in t?t[s].push(this.points[i]):t[s]=[this.points[i]]})),this.pointLines=this.pointLines.filter((e=>{if(!(e.series in t))return!1;if(e.coords=this._getPointLine(t[e.series]),e._bind.style){e.style={};for(let t in e._bind.style)e.style[t]=e._bind.style[t];e.style["stroke-width"]&&"number"==typeof e.style["stroke-width"]||(e.style["stroke-width"]=1.5)}return!0}))}}}(a,r),function(t){t.prototype._findIntercept=function(t,e,s,i){var r,n=t(e),a=t(s),o=i?this.y2:this.y;if(n<o.min!=a<o.min)r=o.min;else{if(n>o.max==a>o.max)return null;r=o.max}var l,h,p,y,c,d=e+.5*(s-e),u=.25*Math.abs(s-e),g=n,f=e;e-=1e-5,s+=1e-5;for(var x=0;x++<100;){if(l=t(d),h=Math.abs(l-r),d>=this.x.min&&d<=this.x.max&&h<1e-6)return[d,r];if(x>0&&y<h?(d=f,l=g,u*=.5):((p=l>r!=(d>f==l>g))!==c&&(u*=.5),f=d,g=l,c=p,y=h),(d+=c?u:-u)<e||d>s)return null}return null},t.prototype._getLineSegmentsFromCoordinates=function(t,e){for(var s=e?this.y2:this.y,i=[],r=[],n=null,a=!1,o=!1,l=0;l<t.length;l++){var h=t[l];if(void 0!==h[1]&&null!==h[1]){var p=n?(t[l][1]-n[1])/(t[l][0]-n[0]):0;if(a){if(!o&&h[0]>=this.x.max&&(o=!0,h[0]>this.x.max)){if(!n)break;h=[this.x.max,n[0]+p*(h[1]-n[1])]}if(h[1]>=s.min&&h[1]<=s.max){if(0===r.length&&n&&0!==p){var y=p>0?s.min:s.max;h=[(this.x.isDate?n[0].getTime():n[0])+(y-n[1])/p,y],this.x.isDate&&(h[0]=new Date(h[0])),l--}r.push(h)}else r.length>0&&(y=p>0?s.max:s.min,h=[(this.x.isDate?n[0].getTime():n[0])+(y-n[1])/p,y],this.x.isDate&&(h[0]=new Date(h[0])),r.push(h)),r.length>1&&(i.push(r),r=[]);if(o)break;n=h}else{if(h[0]>=this.x.min){if(a=!0,h[0]>this.x.min&&n){var c=[this.x.min,n[0]+p*(h[1]-n[1])];c[1]>=s.min&&c[1]<=s.max&&r.push(c)}h[1]>=s.min&&h[1]<=s.max&&r.push(h)}n=h}}else r.length>1&&i.push(r),r=[],n=null}return r.length>1&&i.push(r),i},t.prototype._getLineSegmentsFromFunction=function(t,e,s,i,r){var n;if(s?(s[0]<this.x.min&&(s[0]=this.x.min),s[1]>this.x.max&&(s[0]=this.x.max)):s=[this.x.min,this.x.max],e&&"number"==typeof e||(e=Math.floor((this.width-this.margins.left-this.margins.right)/10)),e<2&&(e=2),this.x.isLog){var a=Math.pow(s[1]/s[0],1-e);n=function(t){return(t*=a)>s[1]?s[1]:t}}else{var o=(s[1]-s[0])/(e-1),l=this.x.isDate;n=function(t){return l?new DateUTC(t.getTime()+o):t+o}}for(var h=[],p=[],y=s[0],c=y,d=i?this.y2:this.y;;){var u=!1;(y>=s[1]||isNaN(y))&&(y=s[1],u=!0);var g=t(y);if(r){var f;if(g>=d.min&&g<=d.max)0===p.length&&y>s[0]&&(f=this._findIntercept(t,c,y,i))&&p.push(f),p.push([y,g]);else p.length>0&&(f=this._findIntercept(t,c,y,i))&&p.push(f),p.length>1&&(h.push(p),p=[]);if(c=y,y=n(y),u)break}else p.push([y,g])}return p.length>1&&h.push(p),h},t.prototype._getAreaPolysFromCoordinates=function(t,e){for(var s=[],i=[],r=0;r<t.length;r++)s.push([t[r][0],t[r][1]]),i.push([t[r][0],t[r][2]]);return this._getAreaPolysFromLineCrosswalk(this._getLineSegmentsFromCoordinates(s,e),this._getLineSegmentsFromCoordinates(i,e),e)},t.prototype._getAreasPolysFromFunctions=function(t,e,s,i,r,n){return this._getLineSegmentsFromFunction(t,s,i,r,n),this._getLineSegmentsFromFunction(e,s,i,r,n),this._getAreaPolysFromLineCrosswalk(this._getLineSegmentsFromFunction(t,s,i,r,n),this._getLineSegmentsFromFunction(e,s,i,r,n),r)},t.prototype._getAreaPolysFromLineCrosswalk=function(t,e,s){for(var i,r,n=[],a=[],o=[0,0],l=[0,0],h=[!1,!1],p=[!1,!1];;){i=h[0]?null:t[o[0]][l[0]],r=h[1]?null:e[o[1]][l[1]];var y=[!1,!1];if(!i&&!r)break;i&&r?i[0]===r[0]?(a.push([i[0],i[1],r[1]]),y[0]=y[1]=!0):(i[0]<r[0]?y[0]=!0:y[1]=!0,a.length>=2&&n.push(a),a=[]):(y=[!0,!0],a.length>=2&&n.push(a),a=[]);for(var c=[!1,!1],d=0;d<2;d++)if(!h[d]){var u=0===d?t:e;y[d]&&(l[d]+=1),p[d]=l[d]>=u[o[d]].length,p[d]&&(o[d]+=1,l[d]=0,c[d]=!0,h[d]=o[d]>=u.length)}if(c[0]&&c[1]&&(a.length>=2&&n.push(a),a=[]),h[0]&&h[1]){a.length>=2&&n.push(a);break}}return n}}(a),function(t,e){t.prototype.removePoints=function(t){return null==t?this.svgGraph.selectAll(".sg-point").remove():(t=Array.isArray(t)?t:[t],this.svgGraph.selectAll(".sg-point").filter((e=>~t.indexOf(e.series))).remove()),this},t.prototype.drawPoints=function(t,e){if(this.removePoints(),!this.points||0===this.points.length)return this;var s=this.points;if(this.allowDrawBeyondGraph||(s=s.filter((e=>{if(!e.x&&0!==e.x||Number.isNaN(e.x))return!1;if(e.x<this.x.min||e.x>this.x.max)return!1;if(this.x.break&&e.x>this.x.break.domain[0]&&e.x<this.x.break.domain[1])return!1;if(!t&&isNaN(e.y))return!1;let s=e.y2?this.y2:this.y;return!(e.y<s.min||e.y>s.max||s.break&&e.y>s.break.domain[0]&&e.y<s.break.domain[1])}))),!s.length)return this;var i={};s.forEach((t=>{t.series in i?i[t.series].push(t):i[t.series]=[t]}));for(let t in i)this._drawPoints(this.svgGraph.selectAll(".sg-temporary-point").data(i[t]).enter(),this.ptSeriesShapes[t],e);return this},t.prototype.drawUpdatePoints=function(t,s){if(!this.points||0===this.points.length)return this.removePoints(),this.removePointLines(),this;s&&(Object.getPrototypeOf(s)!==Object.prototype&&(s={}),s.duration=s.duration||200,s.ease=s.ease||e.easePolyOut);var i=this.points;this.allowDrawBeyondGraph||(i=i.filter((e=>{if(!e.x&&0!==e.x||Number.isNaN(e.x))return!1;if(e.x<this.x.min||e.x>this.x.max)return!1;if(this.x.break&&e.x>this.x.break.domain[0]&&e.x<this.x.break.domain[1])return!1;if(!t&&isNaN(e.y))return!1;let s=e.y2?this.y2:this.y;return!(e.y<s.min||e.y>s.max||s.break&&e.y>s.break.domain[0]&&e.y<s.break.domain[1])})));var r={};i.forEach((t=>{t.series in r?r[t.series].push(t):r[t.series]=[t]}));for(let t in r){var n=r[t],a=this.ptSeriesShapes[t],o=this.svgGraph.selectAll(".sg-point").filter((e=>e.series===t));o.filter((t=>!~n.indexOf(t))).remove(),o=o.filter((t=>~n.indexOf(t)));var l=[...n];o.each((t=>{let e=l.indexOf(t);~e&&l.splice(e,1)})),this._drawPoints(this.svgGraph.selectAll(".sg-temporary-point").data(l).enter(),a,s),this._updatePoints(o,a,s)}return this},t.prototype._drawPoints=function(t,s,i){if(t.size()){var r;switch(s){case"triangle":case"triangle-up":case"triangle-down":r=t.append("polygon");break;case"square":case"diamond":r=t.append("rect");break;default:r=t.append("circle")}r=this._formatPoint(r,s,i),i&&(Object.getPrototypeOf(i)!==Object.prototype&&(i={}),i.duration=i.duration||200,i.ease=i.ease||e.easePolyOut,r.transition().duration(i.duration).ease(i.ease).style("opacity",(t=>t.style&&"opacity"in t.style?t.style.opacity:1)))}},t.prototype._updatePoints=function(t,s,i){t.size()&&(i&&(Object.getPrototypeOf(i)!==Object.prototype&&(i={}),i.duration=i.duration||200,i.ease=i.ease||e.easePolyOut,t=t.transition().duration(i.duration).ease(i.ease)),this._formatPoint(t,s))},t.prototype._formatPoint=function(t,e,s){switch(e){case"triangle-down":t.attr("series",(t=>t.series)).style("opacity",s?0:1).attr("class","sg-point sg-point-td").attr("points",(t=>{let e=e="function"==typeof t.size?t.size():t.size,s=1.519676*e,i=.86602*s*.5,r=.5*s,n=this.x.scale(t.x),a=isNaN(t.y)?0:t.y;return a=(t.y2?this.y2.scale:this.y.scale)(a),`${n-r},${a+i} ${n},${a-i} ${n+r},${a+i}`}));break;case"triangle":case"triangle-up":t.attr("series",(t=>t.series)).style("opacity",s?0:1).attr("class","sg-point sg-point-tu").attr("points",(t=>{let e=e="function"==typeof t.size?t.size(t,t._bind):t.size,s=1.519676*e,i=.86602*s*.5,r=.5*s,n=this.x.scale(t.x),a=isNaN(t.y)?0:t.y;return a=(t.y2?this.y2.scale:this.y.scale)(a),`${n-r},${a-i} ${n},${a+i} ${n+r},${a-i}`}));break;case"square":case"diamond":t.attr("series",(t=>t.series)).style("opacity",s?0:1).attr("class","sg-point sg-point-sd").attr("width",(t=>"function"==typeof t.size?t.size():t.size)).attr("height",(t=>"function"==typeof t.size?t.size():t.size)).attr("x",(t=>{let e="function"==typeof t.size?t.size():t.size;return this.x.scale(t.x)-e/2})).attr("y",(t=>{isNaN(t.y)||t.y;let e="function"==typeof t.size?t.size():t.size;return(t.y2?this.y2.scale:this.y.scale)(t.y)-e/2})).attr("transform",(t=>{if("diamond"!==e)return"";let s=isNaN(t.y)?0:t.y;return`rotate(45,${this.x.scale(t.x)},${(t.y2?this.y2.scale:this.y.scale)(s)})`}));break;default:t.style("opacity",s?0:1).attr("series",(t=>t.series)).attr("class","sg-point sg-point-cr").attr("r",(t=>.5*("function"==typeof t.size?t.size(t):t.size))).attr("cx",(t=>this.x.scale(t.x))).attr("cy",(t=>{let e=isNaN(t.y)?0:t.y;return(t.y2?this.y2.scale:this.y.scale)(e)}))}return t.style("fill",(t=>{let e=this.getColorBySeriesName(t.series,!0);return"function"==typeof e?e(t):e})).style("stroke",(t=>{let e=this.getColorBySeriesName(t.series,!0);return"function"==typeof e?e(t):e})),t}}(a,r),function(t,e){t.prototype.removeAllLines=function(t){return this.removeLines(t).removePointLines(t)},t.prototype.removeLines=function(t){let e;return null==t?e=this.svgGraph.selectAll(".sg-line").remove():(e=Array.isArray(t)?t:[t],this.svgGraph.selectAll(".sg-line").filter((e=>~t.indexOf(e.series))).remove()),e.each((t=>{t._segments=null,t._d3s=null})),this},t.prototype.removePointLines=function(t){let e;return null==t?e=this.svgGraph.selectAll(".sg-point-line").remove():(e=Array.isArray(t)?t:[t],this.svgGraph.selectAll(".sg-point-line").filter((e=>~t.indexOf(e.series))).remove()),e.each((t=>{t._segments=null,t._d3s=null})),this},t.prototype.drawAllLines=function(t,e){return this.drawPointLines().drawLines(t,e)},t.prototype.drawLines=function(t,e){if(this.removeLines(),t||0===t?t<=2&&(t=2):t=20,!this.lines)return this;var s=this;return this.lines.forEach((e=>{e.lineFunction?e._segments=s._getLineSegmentsFromFunction(e.lineFunction,t,e.xRange,e.y2Axis,!s.allowDrawBeyondGraph):s.allowDrawBeyondGraph?e._segments=[e.coords]:e._segments=s._getLineSegmentsFromCoordinates(e.coords,e.y2),e._segments&&(e._segments=e._segments.filter((t=>t&&t.length>=2)))})),this._drawLines(this.lines,"sg-line"),this},t.prototype.drawPointLines=function(t){if(this.removePointLines(),!this.pointLines)return this;var e=this;return this.pointLines.forEach((t=>{e.allowDrawBeyondGraph?t._segments=[t.coords]:t._segments=e._getLineSegmentsFromCoordinates(t.coords,t.y2),t._segments&&(t._segments=t._segments.filter((t=>t&&t.length>=2)))})),this._drawLines(this.pointLines,"sg-point-line",t),this},t.prototype.drawUpdateAllLines=function(t,e){return this.drawUpdateLines(t,e).drawUpdatePointLines(e)},t.prototype.drawUpdateLines=function(t,s){t||0===t?t<=2&&(t=2):t=20,s&&(Object.getPrototypeOf(s)!==Object.prototype&&(s={}),s.duration=s.duration||200,s.ease=s.ease||e.easePolyOut);var i=this;return this.lines.forEach((e=>{e.lineFunction?e._segments=i._getLineSegmentsFromFunction(e.lineFunction,t,e.xRange,e.y2Axis,!i.allowDrawBeyondGraph):i.allowDrawBeyondGraph?e._segments=[e.coords]:e._segments=i._getLineSegmentsFromCoordinates(e.coords,e.y2),e._segments&&(e._segments=e._segments.filter((t=>t&&t.length>=2)))})),i._updateLines(this.lines,"sg-line",s),this},t.prototype.drawUpdatePointLines=function(t){t&&(Object.getPrototypeOf(t)!==Object.prototype&&(t={}),t.duration=t.duration||200,t.ease=t.ease||e.easePolyOut);var s=this;return this.pointLines.forEach((t=>{s.allowDrawBeyondGraph?t._segments=[t.coords]:t._segments=s._getLineSegmentsFromCoordinates(t.coords,t.y2),t._segments&&(t._segments=t._segments.filter((t=>t&&t.length>=2)))})),s._updateLines(this.pointLines,"sg-point-line",t),this},t.prototype._drawLines=function(t,s,i){var r=this,n=this.svgGraph.selectAll(".sg-temporary-line").data(t).enter().append("path").attr("series",(t=>t.series)).attr("class",s).style("opacity",i?0:1).style("fill","none").attr("d",(t=>{let s=t.y2?this.y2:this.y,i=e.line().x((t=>this.x.scale(t[0]))).y((t=>s.scale(t[1]))).curve(t.interpolate);return t._segments.reduce(((t,e)=>(t||"")+(e.length<2?"":" "+i(e))),"")})).each((function(t){let s=e.select(this),n=t.style||{};for(let t in n)(!i||t&&"opacity"!=t.toLowerCase())&&s.style(t,n[t]);if(!("stroke"in n)){let e=r.getColorBySeriesName(t.series,!0);s.style("stroke","function"==typeof e?e(t):e)}t._d3s=s}));i&&(Object.getPrototypeOf(i)!==Object.prototype&&(i={}),i.duration=i.duration||200,i.ease=i.ease||e.easePolyOut,n.transition().duration(i.duration).ease(i.ease).style("opacity",(t=>t.style&&"opacity"in t.style?t.style.opacity:1)))},t.prototype._updateLines=function(t,s,i){if(!t)return this;var r=t.filter((t=>t._segments&&t._segments.length&&!t._segments.filter((t=>t.length<2)).length?!t._d3s:(segments._d3s&&(t._d3s.remove(),t._d3s=null),!1))),n=this.svgGraph.selectAll("."+s);i&&(n=n.transition().duration(i.duration).ease(i.ease));var a=this;n.attr("d",(t=>{var s=t.y2?this.y2:this.y,i=e.line().x((t=>this.x.scale(t[0]))).y((t=>s.scale(t[1]))).curve(t.interpolate);return t._segments.reduce(((t,e)=>(t||"")+(e.length<2?"":" "+i(e))),"")})).each((function(t){var s=e.select(this),i=t.style||{};for(var r in i)s.style(r,i[r]);if(!("stroke"in i)){let e=a.getColorBySeriesName(t.series,!0);s.style("stroke","function"==typeof e?e(t):e)}}));var o=this.svgGraph.selectAll(".sg-temporary-line").data(r).enter().append("path").attr("series",(t=>t.series)).attr("class",s).style("opacity",i?0:1).style("fill","none").attr("d",(t=>{var s=t.y2?a.y2:a.y,i=e.line().x((t=>a.x.scale(t[0]))).y((t=>s.scale(t[1]))).curve(t.interpolate);return t._segments.reduce(((t,e)=>(t||"")+(e.length<2?"":" "+i(e))),"")})).each((function(t){var s=e.select(this),r=t.style||{};for(var n in r)(!i||n&&"opacity"!=n.toLowerCase())&&s.style(n,r[n]);if(!("stroke"in r)){let e=a.getColorBySeriesName(t.series,!0);s.style("stroke","function"==typeof e?e(t):e)}t._d3s=s}));i&&(i.duration=i.duration||200,i.ease=i.ease||e.easePolyOut,o.transition().duration(i.duration).ease(i.ease).style("opacity",(t=>t.style&&"opacity"in t.style?t.style.opacity:1)))}}(a,r),function(t,e){t.prototype.removeAreas=function(t){return null==t?this.svgGraph.selectAll(".sg-area").remove():(removed=Array.isArray(t)?t:[t],this.svgGraph.selectAll(".sg-area").filter((e=>~t.indexOf(e.series))).remove()),this},t.prototype.drawAreas=function(t,e){return this.removeAreas(),t||0===t?t<=2&&(t=2):t=20,this.areas?(this.areas.forEach((t=>{t.functions?t._parts=this._getAreasPolysFromFunctions(t.functions[0],t.functions[1],t.resolution,t.xRange,t.y2,!this.allowDrawBeyondGraph):this.allowDrawBeyondGraph?t._parts=[t.coords]:t._parts=this._getAreaPolysFromCoordinates(t.coords,t.y2),t._parts&&(t._parts=t._parts.filter((t=>t&&t.length>=2)))})),this._drawAreas(t,e),this):this},t.prototype.drawUpdateAreas=function(t,e){return t||0===t?t<=2&&(t=2):t=20,this.areas.forEach((t=>{t.functions?t._parts=this._getAreasPolysFromFunctions(t.functions[0],t.functions[1],t.resolution,t.xRange,t.y2,!this.allowDrawBeyondGraph):this.allowDrawBeyondGraph?t._parts=[t.coords]:t._parts=this._getAreaPolysFromCoordinates(t.coords,t.y2),t._parts&&(t._parts=t._parts.filter((t=>t&&t.length>=2)))})),this._updateAreas(e),this},t.prototype._drawAreas=function(t,s){if(this.areas){var i=this,r=this.svgGraph.selectAll(".sg-temporary-area").data(this.areas).enter().append("path").attr("series",(t=>t.series)).attr("class","sg-area").style("opacity",s?0:1).attr("d",(t=>{let s=t.y2?this.y2:this.y,i=e.area().x((t=>this.x.scale(t[0]))).y0((t=>s.scale(t[1]))).y1((t=>s.scale(t[2]))).curve(t.interpolate);return t._parts.reduce(((t,e)=>e.length<2?t:t+" "+i(e)),"")})).each((function(t){var r=e.select(this),n=t.style||{};for(let t in n)(!s||t&&"opacity"!=t.toLowerCase())&&r.style(t,n[t]);if(!("fill"in n)){let e=i.getColorBySeriesName(t.series,!0);r.style("fill","function"==typeof e?e(t):e)}t._d3s=r}));s&&(Object.getPrototypeOf(s)!==Object.prototype&&(s={}),s.duration=s.duration||200,s.ease=s.ease||e.easePolyOut,r.transition().duration(s.duration).ease(s.ease).style("opacity",(t=>t.style&&"opacity"in t.style?t.style.opacity:1)))}},t.prototype._updateAreas=function(t){if(this.areas){t&&(Object.getPrototypeOf(t)!==Object.prototype&&(t={}),t.duration=t.duration||200,t.ease=t.ease||e.easePolyOut);var s=this.areas.filter((t=>t._parts&&t._parts.length&&!t._parts.filter((t=>t.length<2)).length?!t._d3s:(segments._d3s&&(t._d3s.remove(),t._d3s=null),!1))),i=this.svgGraph.selectAll(".sg-area");t&&(i=i.transition().duration(t.duration).ease(t.ease));var r=this;i.attr("d",(t=>{let s=t.y2?this.y2:this.y,i=e.area().x((t=>this.x.scale(t[0]))).y0((t=>s.scale(t[1]))).y1((t=>s.scale(t[2]))).curve(t.interpolate);return t._parts.reduce(((t,e)=>e.length<2?t:t+" "+i(e)),"")})).each((function(t){var s=e.select(this),i=t.style||{};for(let t in i)s.style(t,i[t]);if(!("fill"in i)){let e=r.getColorBySeriesName(t.series,!0);s.style("fill","function"==typeof e?e(t):e)}}));var n=this.svgGraph.selectAll(".sg-temporary-area").data(s).enter().append("path").attr("series",(t=>t.series)).attr("class","sg-area").style("opacity",t?0:1).attr("d",(t=>{let s=t.y2?this.y2:this.y,i=e.area().x((t=>this.x.scale(t[0]))).y0((t=>s.scale(t[1]))).y1((t=>s.scale(t[2]))).curve(t.interpolate);return t._parts.reduce(((t,e)=>e.length<2?t:t+" "+i(e)),"")})).each((function(s){var i=e.select(this),n=s.style||{};for(let e in n)(!t||e&&"opacity"!=e.toLowerCase())&&i.style(e,n[e]);if(!("fill"in n)){let t=r.getColorBySeriesName(s.series,!0);i.style("fill","function"==typeof t?t(s):t)}s._d3s=i}));t&&(t.duration=t.duration||200,t.ease=t.ease||e.easePolyOut,n.transition().duration(t.duration).ease(t.ease).style("opacity",(t=>t.style&&"opacity"in t.style?t.style.opacity:1)))}}}(a,r),function(t,e){t.prototype.addTooltipToPoints=function(t,e,s){return e=e&&!Array.isArray(e)?[e]:e,this.svgGraph.selectAll(".sg-point").filter((t=>!e||~e.indexOf(t.series))).call(this._constructTooltipFunctionality(t,s)),this},t.prototype.addTooltipToLines=function(t,e,s){return e=e&&!Array.isArray(e)?[e]:e,this.svgGraph.selectAll(".sg-line").filter((t=>!e||~e.indexOf(t.series))).call(this._constructTooltipFunctionality(t,s)),this},t.prototype.addTooltipToAreas=function(t,e,s){return e=e&&!Array.isArray(e)?[e]:e,this.svgGraph.selectAll(".sg-area").filter((t=>!e||~e.indexOf(t.series))).call(this._constructTooltipFunctionality(t,s)),this},t.prototype._constructTooltipFunctionality=function(t,s){var i=this.svgGraph.node();return function(r){if(!r)return null;s||(s={});var n,a=e.select("body"),o=s.offset||[15,15],l=r._groups[0];r.on("mouseover.sg-tooltip",(function(t,r){let h,p=e.pointer(t,a.node());n?h={left:p[0]+o[0]+"px",top:p[1]+o[1]+"px"}:(a.selectAll(".sg-tooltip").remove(),(n=a.append("div")).attr("class","sg-tooltip"),h={position:"absolute",left:p[0]+o[0]+"px",top:p[1]+o[1]+"px","z-index":1001,"background-color":"#fff",border:"1px solid #777","border-radius":"4px",padding:"4px 6px","font-family":"'Century Gothic', CenturyGothic, Geneva, AppleGothic, sans-serif","font-size":"12px"});for(let t in h)n.style(t,h[t]);if(s.style)for(let t in s.style)n.style(t,s.style[t]);s.mouseover&&s.mouseover(r,e.pointer(t,i),l)})).on("mousemove.sg-tooltip",(function(s,r){if(n){let h=e.pointer(s,a.node());n.style("left",h[0]+o[0]+"px").style("top",h[1]+o[1]+"px");let p=null;t&&(p=t(r,e.pointer(s,i),l)),p?n.html(p):(n.remove(),n=null)}})).on("mouseout.sg-tooltip",(function(t,r){s.mouseout&&s.mouseout(r,e.pointer(t,i),l),n&&(n.remove(),n=null)}))}},t.prototype.highlightPoints=function(t,e,s,i,r){var n=".sg-point";t&&(n+="[series='"+t+"']");var a=this;return this.svgGraph.selectAll(n).each((function(t,n,o){if(!e||e(t)){var l=a.x.scale,h=t.y2?a.y2.scale:a.y.scale;s||(s=t.wasNull?0:"function"==typeof t.pointsize?t.pointsize():t.pointsize),i||(i=t.wasNull?"none":a.getColorBySeriesName(t.series,!0));var p=s||t.pointsize;"function"==typeof p&&(p=p.call(t));var y=a.svgGraph.append("rect").attr("class","sg-point-highlight").attr("width",p).attr("height",p).attr("x",l(t.x)-p/2).attr("y",h(t.y)-p/2).attr("transform","rotate(45,"+l(t.x)+","+h(t.y)+")").style("fill",i);if(r)for(var c in r)y.style(c,r[c])}})),this},t.prototype.removeHighlightPoints=function(){return this.svgGraph.selectAll(".sg-point-highlight").remove(),this},t.prototype.removeHighlights=function(){return this.removeHighlightPoints(),this}}(a,r),function(t,e){t.prototype.removeHighlights=function(){return this.removeHighlightPoints().removeHighlightLines().removeHighlightAreas()},t.prototype.removeHighlightPoints=function(){return this.svgGraph.selectAll(".sg-point-highlight").remove(),this.svgGraph.selectAll(".sg-point.sg-highlight-hide").style("opacity","").classed("sg-highlight-hide",!1),this},t.prototype.removeHighlightLines=function(){return this.svgGraph.selectAll(".sg-line-highlight").remove(),this.svgGraph.selectAll(".sg-line.sg-highlight-hide").style("opacity","").classed("sg-highlight-hide",!1),this},t.prototype.removeHighlightAreas=function(){return this.svgGraph.selectAll(".sg-area-highlight").remove(),this.svgGraph.selectAll(".sg-area.sg-highlight-hide").style("opacity","").classed("sg-highlight-hide",!1),this},t.prototype._addBlurDefn=function(){this.svgDefs.select("#sg-effect-blur").empty()&&this.svgDefs.append("filter").attr("id","sg-effect-blur").append("feGaussianBlur").attr("in","SourceGraphic").attr("stdDeviation",6)},t.prototype.highlightPoints=function(t){return(t=t||{}).series&&(t.series=Array.isArray(t.series)?t.series:[t.series]),this.svgGraph.selectAll(".sg-point").each(((s,i,r)=>{if(t.series&&!~t.series.indexOf(s.series))return;if(t.filter&&!t.filter(this._clonePointData(s),r[i]))return;let n=e.select(r[i].cloneNode(!0)).attr("class","sg-point-highlight"),a=this.x.scale,o=s.y2?this.y2.scale:this.y.scale,l=a(s.x),h=o(isNaN(s.y)?0:s.y),p=t.size||s.size;switch("function"==typeof p&&(p=p.call(s)),this.ptSeriesShapes[s.series]){case"triangle":case"triangle-up":p*=2,n.attr("points",(t=>{let e=1.519676*p,s=.86602*e*.5,i=.5*e;return`${l-i},${h-s} ${l},${h+s} ${l+i},${h-s}`}));break;case"triangle-down":p*=2,n.attr("points",(t=>{let e=1.519676*p,s=.86602*e*.5,i=.5*e;return`${l-i},${h+s} ${l},${h-s} ${l+i},${h+s}`}));break;case"square":case"diamond":n.attr("width",p).attr("height",p).attr("x",l-p/2).attr("y",h-p/2);break;default:n.attr("r",p)}if(t.nooutline||(n.style("stroke","#000"),n.style("stroke-width","1")),t.style)for(let e in t.style)n.style(e,t.style[e]);n.style("pointer-events","none"),this.svgGraph.node().append(n.node()),e.select(r[i]).classed("sg-highlight-hide",!0).style("opacity","0")})),this},t.prototype.highlightLines=function(t){return(t=t||{}).series&&(t.series=Array.isArray(t.series)?t.series:[t.series]),this._addBlurDefn(),this.svgGraph.selectAll(".sg-line").each(((s,i,r)=>{if(t.series&&!~t.series.indexOf(s.series))return;if(t.filter&&!t.filter(this._cloneLineData(s),r[i]))return;let n=e.select(r[i].cloneNode(!0)).attr("class","sg-point-highlight"),a=null;if(!t.noblur){if(a=e.select(r[i].cloneNode(!0)).attr("class","sg-line-highlight").attr("filter","url('#sg-effect-blur')").style("fill","none").style("filter","brightness(135%)").style("opacity","0.7"),t.blurstyle)for(let e in t.blurstyle)a.style(e,t.blurstyle[e]);a.style("pointer-events","none"),this.svgGraph.node().append(a.node())}if(t.style)for(let e in t.style)n.style(e,t.style[e]);n.style("pointer-events","none"),this.svgGraph.node().append(n.node()),e.select(r[i]).classed("sg-highlight-hide",!0).style("opacity","0")})),this},t.prototype.highlightAreas=function(t){return(t=t||{}).series&&(t.series=Array.isArray(t.series)?t.series:[t.series]),this.svgGraph.selectAll(".sg-area").each(((s,i,r)=>{if(t.series&&!~t.series.indexOf(s.series))return;if(t.filter&&!t.filter(this._cloneAreaData(s),r[i]))return;let n=e.select(r[i].cloneNode(!0)).attr("class","sg-point-highlight").style("opacity","1");if(t.nooutline||(n.style("stroke","#000"),n.style("stroke-width","1.5")),t.style)for(let e in t.style)n.style(e,t.style[e]);n.style("pointer-events","none"),this.svgGraph.node().append(n.node()),e.select(r[i]).classed("sg-highlight-hide",!0).style("opacity","0")})),this}}(a,r),a.prototype.clearAllData=function(t){return this.clearPointsData(t),this.clearLinesData(t),this.clearAreasData(t),this},a.prototype.removeAll=function(t){return this.removePoints(t).removeAllLines(t).removeAreas(t),this},a.prototype.saveAsPng=function(t){t||(t="graph.png"),t.toLowerCase().endsWith(".png")||(t+=".png");let e=this.svg.attr("version","1.1").attr("xmlns","http://www.w3.org/2000/svg").attr("xmlns:xlink","http://www.w3.org/1999/xlink").node();serializer=new XMLSerializer,svgHtml=serializer.serializeToString(e),canvas=document.createElement("canvas"),canvas.style.display="none",canvas.width=this.containerWidth,canvas.height=this.containerHeight;let s=document.createElement("a");s.style.display="none",s.download=t,this.svg.node().parentNode.appendChild(s);let i=new Image;i.onload=function(){canvas.getContext("2d").drawImage(i,0,0),s.href=canvas.toDataURL("image/png"),s.click(),s.parentElement.removeChild(s),canvas.remove()},i.src="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(svgHtml)))};const o=a;var l=s.A;export{l as default};